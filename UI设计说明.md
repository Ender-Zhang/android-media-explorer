# MediaExplorer UI 设计说明

## 设计理念

MediaExplorer 采用简洁、现代、直观的设计风格，遵循 Material Design 3 设计规范，为用户提供最佳的浏览体验。

## 主要改进（v1.1）

### 🎨 全新的媒体详情页

#### 之前的问题
- ❌ 打开详情页时，下方立即显示详细信息
- ❌ 媒体内容只占一半屏幕
- ❌ 视频缩略图无法正常显示
- ❌ 信息展示不够直观

#### 现在的设计 ✅

1. **全屏沉浸式体验**
   - 媒体内容占满整个屏幕
   - 图片和视频以最大尺寸展示
   - 纯黑色背景，突出内容本身

2. **浮动控制按钮**
   - 左上角：关闭按钮（半透明黑色圆形）
   - 右上角：信息按钮（半透明黑色圆形，点击后变为主题色）
   - 不遮挡主要内容区域

3. **按需显示信息**
   - 默认隐藏详细信息
   - 点击信息按钮后从底部滑出
   - 带有流畅的动画效果
   - 再次点击可收起

4. **美观的信息面板**
   - 圆角卡片设计（顶部 24dp 圆角）
   - 顶部指示器（横线）
   - 文件名使用大标题字体
   - 关键信息用彩色芯片卡片展示
   - 图标 + 文字的直观表达

### 🖼️ 视频缩略图修复

#### 技术实现
使用 Coil 的 `videoFrameMillis` 功能：
```kotlin
ImageRequest.Builder(context)
    .data(mediaItem.uri)
    .videoFrameMillis(1000) // 提取第1秒的帧
    .crossfade(true)
    .build()
```

#### 效果
- ✅ 视频缩略图正常显示
- ✅ 提取视频第1秒作为缩略图
- ✅ 带有淡入淡出效果
- ✅ 保持图片和视频统一的展示风格

## UI 组件详解

### 1. 主界面（MediaExplorerApp）

#### 布局结构
```
TopAppBar（顶部栏）
├── 标题："媒体浏览器"
└── 刷新按钮

FilterTabs（过滤标签）
├── 全部
├── 照片
└── 视频

MediaGrid（媒体网格）
└── 3列网格布局
    ├── 图片缩略图
    └── 视频缩略图
        ├── 播放图标覆层
        └── 时长标签
```

#### 设计特点
- 简洁的顶部导航
- 清晰的分类标签
- 网格间距：4dp
- 正方形缩略图（1:1 比例）
- 视频带半透明黑色覆层和播放图标

### 2. 详情页（MediaDetailDialog）

#### 布局层次
```
全屏黑色背景
├── 媒体内容层（居中显示）
│   ├── 图片查看器（ContentScale.Fit）
│   └── 视频播放器（ExoPlayer）
│
├── 顶部控制栏（浮动）
│   ├── 关闭按钮（左上角）
│   └── 信息按钮（右上角）
│
└── 底部信息面板（可展开）
    ├── 顶部指示器
    ├── 文件名（大标题）
    ├── 关键信息芯片
    │   ├── 类型 🎬/🖼️
    │   ├── 大小 💾
    │   ├── 分辨率 📐
    │   └── 时长 ⏱️
    ├── 分割线
    └── 详细信息
        ├── 创建时间
        ├── 文件路径
        └── MIME 类型
```

#### 交互设计

**打开详情页**
1. 点击缩略图
2. 全屏展开动画
3. 媒体内容自动加载
4. 视频自动准备（但不自动播放）

**查看信息**
1. 点击右上角 ℹ️ 按钮
2. 信息面板从底部滑出（300ms 动画）
3. 按钮变为蓝色（高亮状态）
4. 再次点击可收起

**关闭详情**
1. 点击左上角 ✕ 按钮
2. 或点击系统返回键
3. 自动释放播放器资源

### 3. 信息面板组件

#### InfoChip（信息芯片）
- **外观**：圆角矩形卡片（12dp 圆角）
- **颜色**：次要容器色（secondaryContainer）
- **内容**：Emoji 图标 + 文字
- **布局**：居中对齐，内边距 12dp×10dp

#### DetailInfoRow（详细信息行）
- **标签**：小字体，次要文字色
- **内容**：常规字体，主要文字色
- **间距**：垂直 6dp

## 颜色方案

### 主界面
- **背景色**：Material 主题背景
- **卡片色**：Surface
- **主色调**：Primary（蓝色）
- **文字色**：OnSurface

### 详情页
- **背景色**：纯黑 (#000000)
- **浮动按钮**：半透明黑 (alpha=0.6)
- **激活状态**：Primary
- **信息面板**：Surface（白色/浅色）

### 芯片卡片
- **背景色**：SecondaryContainer
- **文字色**：OnSecondaryContainer
- **强调色**：Primary

## 动画效果

### 1. 信息面板展开/收起
```kotlin
AnimatedVisibility(
    enter = slideInVertically(initialOffsetY = { it }) 
          + fadeIn(300ms),
    exit = slideOutVertically(targetOffsetY = { it }) 
         + fadeOut(300ms)
)
```

### 2. 图片加载淡入
```kotlin
AsyncImage(
    // Coil 自动淡入效果
    crossfade = true
)
```

### 3. 按钮状态变化
- 信息按钮点击时颜色平滑过渡
- 使用 Material 3 默认动画

## 视觉层次

### Z-Index 层级（从底到顶）
1. **Level 0**：黑色背景
2. **Level 1**：媒体内容（图片/视频）
3. **Level 2**：浮动按钮（8dp elevation）
4. **Level 3**：信息面板（8dp elevation）

### 文字层次
1. **标题级**：titleLarge, Bold（文件名）
2. **正文级**：bodyMedium（详细信息）
3. **标签级**：labelMedium（字段名称）
4. **芯片级**：bodyMedium, Medium（芯片文字）

## 响应式设计

### 适配不同屏幕
- **手机竖屏**：信息面板最大高度 400dp
- **手机横屏**：信息面板自动调整宽度
- **平板**：保持相同布局逻辑

### 触摸目标
- **按钮尺寸**：48dp × 48dp（符合无障碍标准）
- **芯片高度**：≥44dp
- **列表项间距**：≥8dp

## 无障碍设计

### ContentDescription
- ✅ 所有图标都有描述
- ✅ 媒体内容标注文件名
- ✅ 按钮状态可被读屏软件识别

### 对比度
- ✅ 文字与背景对比度 ≥4.5:1
- ✅ 重要按钮对比度 ≥3:1

### 触摸区域
- ✅ 所有可点击元素 ≥48dp
- ✅ 足够的间距避免误触

## 性能优化

### 图片加载
- 使用 Coil 异步加载
- 自动内存缓存
- 视频帧提取不阻塞 UI

### 动画性能
- 使用硬件加速
- 300ms 快速动画
- 避免过度绘制

### 资源释放
- 退出详情页自动释放播放器
- 缩略图按需加载
- LazyVerticalGrid 懒加载

## 用户体验亮点

1. **零学习成本**
   - 熟悉的相册浏览方式
   - 直观的图标和按钮
   - 清晰的视觉反馈

2. **高效操作**
   - 一键查看详情
   - 按需显示信息
   - 快速返回列表

3. **沉浸式体验**
   - 全屏查看内容
   - 最小化干扰元素
   - 流畅的动画过渡

4. **信息清晰**
   - 关键信息图标化
   - 分组展示
   - 层次分明

## 对比总结

| 功能 | 旧设计 | 新设计 |
|------|--------|--------|
| 媒体展示区域 | 50%屏幕 | 100%全屏 |
| 信息显示方式 | 始终显示 | 按需展开 |
| 视频缩略图 | ❌ 无法显示 | ✅ 正常显示 |
| 操作按钮 | 顶栏固定 | 浮动按钮 |
| 信息面板 | 列表形式 | 卡片 + 芯片 |
| 动画效果 | 无 | 流畅过渡 |
| 视觉层次 | 扁平 | 清晰分层 |

---

**设计版本**: 1.1  
**更新日期**: 2025-10-03  
**设计原则**: 简洁、直观、高效、美观

