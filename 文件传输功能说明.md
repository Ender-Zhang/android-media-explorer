# 文件传输功能说明

## 功能概述

MediaExplorer 现在支持将手机上的照片和视频**剪切传输**到电脑。这意味着文件传输完成后，原文件将从手机上删除，类似于"剪切-粘贴"操作。

## 主要特性

### 1. 选择模式
- **进入选择模式**：点击主界面右上角的选择按钮（✓图标）
- **选择文件**：点击照片或视频即可选中/取消选中
- **全选**：点击顶部的全选按钮选中当前页面所有文件
- **反选**：点击反选按钮反转当前选择状态
- **退出选择模式**：点击左上角的关闭按钮（×图标）

### 2. 文件传输
- 选中文件后，点击右上角的菜单按钮（⋮）
- 选择"剪切传输到电脑"
- 点击"启动传输"按钮

### 3. 在电脑上下载文件

#### 步骤 1：确保连接同一WiFi
确保手机和电脑连接到同一个WiFi网络。

#### 步骤 2：访问传输页面
1. 启动传输后，手机会显示一个URL地址，格式为：`http://192.168.x.x:8080`
2. 在电脑的浏览器中输入这个地址

#### 步骤 3：下载文件
- 浏览器会显示所有待传输的文件列表
- 每个文件都有详细信息：
  - 文件名
  - 文件类型（图片/视频）
  - 文件大小
  - 分辨率
  - 时长（视频文件）
  - 修改时间
- 点击单个文件的"下载"按钮下载该文件
- 或点击"全部下载"按钮下载所有文件

### 4. 完成传输并删除文件

⚠️ **重要提示**：这一步将从手机中永久删除已传输的文件，请确保文件已在电脑上保存好！

1. 确认所有需要的文件都已下载到电脑
2. 在手机上点击"完成传输并删除"按钮
3. 应用会自动：
   - 删除已选中的文件
   - 停止传输服务器
   - 刷新媒体列表
   - 显示删除结果

## 使用场景

### 场景 1：清理手机空间
当手机存储空间不足时，可以将照片和视频传输到电脑并删除，释放空间。

### 场景 2：整理照片
定期将手机上的照片和视频备份到电脑，保持手机整洁。

### 场景 3：批量处理
需要在电脑上处理或编辑多个照片/视频时，可以快速批量传输。

## 技术实现

### 传输协议
- 使用 HTTP 协议进行文件传输
- 内置轻量级 HTTP 服务器
- 端口：8080

### 安全特性
- 仅在本地网络内可访问
- 服务器在传输完成后自动关闭
- 需要用户手动确认删除操作

### 文件删除
- Android 11+ 使用 MediaStore API 删除
- Android 10 及以下使用文件系统 API 删除
- 删除失败时会显示详细统计信息

## 注意事项

### ⚠️ 安全提醒
1. **不可逆操作**：删除后文件无法恢复，请务必确认电脑上已保存文件
2. **网络安全**：建议仅在家庭或公司等可信WiFi网络中使用
3. **同时操作**：传输过程中请勿删除或移动原文件

### 💡 使用建议
1. **分批传输**：如果文件很多，建议分批次选择和传输
2. **验证文件**：在删除前，建议在电脑上打开文件验证其完整性
3. **WiFi连接**：使用WiFi而非移动数据，避免流量消耗（虽然是本地传输，但需要WiFi环境）

### 🔧 故障排除

#### 问题 1：无法访问传输地址
**原因**：手机和电脑可能不在同一网络
**解决**：
- 确认两设备连接到相同的WiFi
- 检查防火墙设置
- 尝试关闭VPN

#### 问题 2：下载速度慢
**原因**：WiFi信号弱或干扰
**解决**：
- 靠近WiFi路由器
- 关闭其他占用带宽的应用

#### 问题 3：删除失败
**原因**：文件可能被其他应用占用
**解决**：
- 关闭可能使用这些文件的应用
- 重启手机后重试

## 权限要求

应用需要以下权限：
- ✅ **存储权限**：读取和删除媒体文件
- ✅ **网络权限**：创建HTTP服务器
- ✅ **WiFi状态**：获取本机IP地址

## 界面说明

### 选择模式界面
- **标题栏**：显示"已选择 X 项"
- **关闭按钮**：左上角，退出选择模式
- **全选按钮**：右上角，选择所有可见文件
- **反选按钮**：右上角，反转选择状态
- **菜单按钮**：右上角，显示操作菜单
- **选中标识**：
  - 已选文件显示蓝色覆盖层和勾选图标
  - 未选文件显示半透明覆盖层和空心圆圈

### 传输对话框
- **阶段 1 - 启动前**：
  - 显示将要传输的文件数量
  - 警告提示
  - "启动传输"按钮

- **阶段 2 - 传输中**：
  - 显示访问URL
  - 使用说明
  - "完成传输并删除"按钮（红色，警告色）
  - "取消"按钮

- **阶段 3 - 完成**：
  - 显示删除结果
  - 自动关闭对话框

## 浏览器传输页面

### 页面布局
- **标题**：📱 媒体文件传输
- **摘要区域**：
  - 待传输文件数量
  - "全部下载"按钮

- **文件列表**：
  - 每个文件显示为一个卡片
  - 包含完整的文件信息
  - 独立的下载按钮

### 样式特点
- 响应式设计，适配不同屏幕
- 清晰的视觉层次
- 易于操作的大按钮

## 更新日志

### v2.0 - 文件传输功能 (2025-10-05)
- ✨ 新增选择模式，支持多选、全选、反选
- ✨ 新增HTTP文件传输服务器
- ✨ 新增剪切传输功能（传输后删除）
- ✨ 新增电脑浏览器访问页面
- 🔒 新增网络权限
- 📱 优化选择模式UI界面

## 未来计划

- [ ] 支持复制传输（不删除原文件）
- [ ] 支持断点续传
- [ ] 支持二维码扫描连接
- [ ] 支持传输进度显示
- [ ] 支持批量重命名
- [ ] 支持创建文件夹分类

## 反馈与支持

如有问题或建议，请通过以下方式联系：
- GitHub Issues
- 应用内反馈

---

**享受便捷的文件传输体验！** 📱➡️💻

